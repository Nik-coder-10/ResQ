<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot - ResQ</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/chatbot.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <img src="photos/logo.png" alt="ResQ Logo" class="logo-img">
                <span>ResQ</span>
            </div>
            <div class="nav-location">
                <div class="location-input-container">
                    <i class="fas fa-map-marker-alt location-icon"></i>
                    <input type="text" id="userLocationInput" placeholder="Enter your location" class="location-input">
                    <button id="updateLocationBtn" class="location-update-btn" title="Update location">
                        <i class="fas fa-check"></i>
                    </button>
                </div>
                <div id="locationStatus" class="location-status">
                    <i class="fas fa-spinner fa-spin"></i>
                </div>
            </div>
            <div class="nav-menu">
                <a href="index.html">Home</a>
                <a href="chatbot.html" class="active">Chatbot</a>
                <a href="helpline.html">Helpline</a>
                <a href="map.html">Map</a>
                <a href="login.html" id="logout">Admin</a>
            </div>
        </div>
    </nav>
    <div class="container">
        <!-- <div class="predictions-section"> -->
            <!-- <h2>Emergency Assistant</h2> -->
            <div class="chat-container">
                <div class="chat-header">
                    <h3>ResQ Assistant</h3>
                </div>
                <div class="chat-messages" id="chatMessages"></div>
                <div class="chat-input-container">
                    <div class="chat-input">
                        <input type="text" id="userInput" placeholder="Type your emergency or first aid question...">
                        <button id="sendButton"><i class="fas fa-paper-plane"></i></button>
                    </div>
                    <div id="quickResponses" class="quick-responses"></div>
                </div>
            </div>
        <!-- </div> -->
    </div>
    <footer class="site-footer">
        ResQ pvt ltd all rights reserved @2025
    </footer>
    
    <!-- Chatbot Script -->
    <script>
        // Chatbot responses database
        const chatbotResponses = {
            'hi': 'Hello! I\'m ResQ, your emergency assistance chatbot. How can I help you today?',
            'hello': 'Hi there! I\'m here to help with first aid and emergency information. What do you need?',
            'help': 'I can help with: \n- First aid instructions\n- Emergency procedures\n- How to stay calm in emergencies\n- Helping others in need\n- And more. Please ask me anything specific!',
            
            // First Aid Responses
            'cpr': 'For CPR: \n1. Check for responsiveness\n2. Call emergency services\n3. Perform 30 chest compressions\n4. Give 2 rescue breaths\n5. Repeat until help arrives',
            'choking': 'For a choking adult/child:\n1. Encourage coughing\n2. Deliver 5 back blows\n3. Perform abdominal thrusts (Heimlich maneuver)\n4. Call emergency services if the obstruction isn\'t cleared',
            'burn': 'For minor burns:\n1. Cool the burn under cool running water for 10-15 minutes\n2. Remove tight items near the burn\n3. Apply aloe vera or moisturizer\n4. Cover with a sterile bandage\n\nFor severe burns, seek medical help immediately.',
            'bleeding': 'To control bleeding:\n1. Apply direct pressure with a clean cloth\n2. Elevate the injured area if possible\n3. Add more layers if blood soaks through\n4. Call emergency services for severe bleeding',
            'fracture': 'For suspected fractures:\n1. Keep the injured area still\n2. Apply ice to reduce swelling\n3. Immobilize the area with a splint if needed\n4. Seek medical attention',
            'heart attack': 'Signs of heart attack (chest pain, shortness of breath, nausea):\n1. Call emergency services immediately\n2. Have the person sit down and rest\n3. Give aspirin if available and not allergic\n4. Be prepared to perform CPR if needed',
            'stroke': 'Remember FAST for stroke:\nF - Face drooping\nA - Arm weakness\nS - Speech difficulty\nT - Time to call emergency services',
            'allergic reaction': 'For severe allergic reactions (anaphylaxis):\n1. Use an epinephrine auto-injector if available\n2. Call emergency services\n3. Help the person remain calm\n4. Loosen tight clothing',
            'poisoning': 'If someone is poisoned:\n1. Call poison control or emergency services\n2. Do NOT induce vomiting unless instructed\n3. Have the container of the substance ready to show medical personnel',
            'seizure': 'During a seizure:\n1. Clear the area of dangerous objects\n2. Cushion the head\n3. Do not restrain the person\n4. Time the seizure\n5. Call emergency services if it lasts more than 5 minutes',
            
            // Emergency Preparedness
            'earthquake': 'During an earthquake:\n1. Drop, Cover, and Hold On\n2. Stay indoors until shaking stops\n3. Stay away from windows\n4. If outside, move to an open area away from buildings',
            'fire': 'In case of fire:\n1. Get out and stay out\n2. Crawl low under smoke\n3. Call emergency services\n4. Use a fire extinguisher only if safe to do so',
            'flood': 'During a flood:\n1. Move to higher ground\n2. Avoid walking or driving through flood waters\n3. Stay away from downed power lines\n4. Follow evacuation orders',
            'tornado': 'During a tornado warning:\n1. Go to a basement or interior room on the lowest floor\n2. Stay away from windows\n3. Cover yourself with a mattress or heavy blankets\n4. If in a vehicle, seek shelter in a sturdy building',
            
            // Mental Health
            'panic': 'To manage panic attacks:\n1. Practice deep breathing (inhale 4s, hold 4s, exhale 6s)\n2. Focus on your senses (5-4-3-2-1 technique)\n3. Use positive self-talk\n4. Find a quiet space if possible',
            'calm': 'To stay calm in emergencies:\n1. Take slow, deep breaths\n2. Focus on the present moment\n3. Break the situation into small steps\n4. Remind yourself that help is available',
            'stress': 'To reduce stress:\n1. Practice deep breathing exercises\n2. Take short breaks when needed\n3. Maintain a routine\n4. Stay connected with loved ones',
            
            // Helping Others
            'help others': 'When helping others in emergencies:\n1. Ensure your own safety first\n2. Call emergency services if needed\n3. Provide basic first aid if trained\n4. Stay with the person until help arrives',
            'first aid kit': 'A basic first aid kit should include:\n- Adhesive bandages in various sizes\n- Sterile gauze pads and adhesive tape\n- Antiseptic wipes and antibiotic ointment\n- Disposable gloves\n- Scissors and tweezers\n- Pain relievers (ibuprofen, acetaminophen)\n- Emergency contact numbers\n- Any personal medications',
            'emergency numbers': 'Important emergency numbers to know:\n- General Emergency: 911 (or your local emergency number)\n- Poison Control: 1-800-222-1222 (US)\n- Local hospital: [Your local number]\n- Non-emergency police: [Your local number]',
            
            // Default response
            'default': 'I\'m here to help with first aid and emergency information. Could you please rephrase your question? You can ask about:\n- First aid procedures (CPR, choking, burns, etc.)\n- Emergency preparedness (earthquakes, fires, etc.)\n- How to help others in need\n- Managing stress in emergencies\n- What to include in a first aid kit'
        };

        // Initialize chat when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            const chatMessages = document.getElementById('chatMessages');
            const userInput = document.getElementById('userInput');
            const sendButton = document.getElementById('sendButton');
            
            function addMessage(message, isUser = false) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${isUser ? 'user-message' : 'bot-message'}`;
                
                // Replace newlines with <br> and split into paragraphs for better formatting
                const formattedMessage = message.replace(/\n/g, '<br>');
                messageDiv.innerHTML = formattedMessage;
                
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            function getBotResponse(userMessage) {
                // Convert to lowercase and remove extra spaces
                const message = userMessage.toLowerCase().trim();
                
                // Check for keywords in the message
                if (message.includes('hi') || message.includes('hello')) {
                    return chatbotResponses.hi;
                } else if (message.includes('help')) {
                    return chatbotResponses.help;
                } else if (message.includes('cpr')) {
                    return chatbotResponses.cpr;
                } else if (message.includes('chok') || message.includes('choking')) {
                    return chatbotResponses.choking;
                } else if (message.includes('burn')) {
                    return chatbotResponses.burn;
                } else if (message.includes('bleed') || message.includes('cut')) {
                    return chatbotResponses.bleeding;
                } else if (message.includes('fracture') || message.includes('broken bone')) {
                    return chatbotResponses.fracture;
                } else if (message.includes('heart attack') || message.includes('chest pain')) {
                    return chatbotResponses['heart attack'];
                } else if (message.includes('stroke') || message.includes('face droop')) {
                    return chatbotResponses.stroke;
                } else if (message.includes('allerg') || message.includes('anaphyla')) {
                    return chatbotResponses['allergic reaction'];
                } else if (message.includes('poison') || message.includes('ingested')) {
                    return chatbotResponses.poisoning;
                } else if (message.includes('seizure') || message.includes('fit')) {
                    return chatbotResponses.seizure;
                } else if (message.includes('earthquake')) {
                    return chatbotResponses.earthquake;
                } else if (message.includes('fire')) {
                    return chatbotResponses.fire;
                } else if (message.includes('flood')) {
                    return chatbotResponses.flood;
                } else if (message.includes('tornado') || message.includes('hurricane')) {
                    return chatbotResponses.tornado;
                } else if (message.includes('panic') || message.includes('anxious')) {
                    return chatbotResponses.panic;
                } else if (message.includes('calm') || message.includes('stay calm')) {
                    return chatbotResponses.calm;
                } else if (message.includes('stress') || message.includes('stressed')) {
                    return chatbotResponses.stress;
                } else if (message.includes('help others') || message.includes('helping others')) {
                    return chatbotResponses['help others'];
                } else if (message.includes('first aid kit') || message.includes('what should be in a first aid kit')) {
                    return chatbotResponses['first aid kit'];
                } else if (message.includes('emergency number') || message.includes('who to call')) {
                    return chatbotResponses['emergency numbers'];
                } else {
                    return chatbotResponses.default;
                }
            }
            
            function handleUserInput() {
                const message = userInput.value.trim();
                if (message === '') return;
                
                // Add user message to chat
                addMessage(message, true);
                userInput.value = '';
                
                // Show typing indicator
                const typingIndicator = document.createElement('div');
                typingIndicator.className = 'message bot-message typing-indicator';
                typingIndicator.innerHTML = 'ResQ is typing...';
                chatMessages.appendChild(typingIndicator);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                // Simulate typing delay
                setTimeout(() => {
                    // Remove typing indicator
                    if (typingIndicator.parentNode) {
                        typingIndicator.remove();
                    }
                    
                    // Get and display response
                    const response = getBotResponse(message);
                    addMessage(response);
                }, 1000);
            }
            
            // Event listeners
            sendButton.addEventListener('click', handleUserInput);
            userInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    handleUserInput();
                }
            });
            
            // Add welcome message
            setTimeout(() => {
                addMessage('Hello! I\'m ResQ, your emergency assistance chatbot. I can help with first aid, emergency procedures, and more. How can I assist you today?');
            }, 500);
        });
    </script>
    <script src="js/chatbot.js"></script>
</body>
</html>
